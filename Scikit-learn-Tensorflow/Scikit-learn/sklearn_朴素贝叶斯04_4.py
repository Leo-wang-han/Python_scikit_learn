#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
@Date: 2025/1/20 0020
@FILE: sklearn_æœ´ç´ è´å¶æ–¯04_4
@Author: Leo
"""

# æœ´ç´ è´å¶æ–¯ç®€ä»‹
"""
æœ´ç´ è´å¶æ–¯ç®—æ³•æ˜¯ä¸€ç§åŸºäºè´å¶æ–¯å®šç†çš„åˆ†ç±»æŠ€æœ¯ï¼Œå…¶ä¸­å¼ºå‡è®¾æ‰€æœ‰é¢„æµ‹å˜é‡å½¼æ­¤ç‹¬ç«‹ã€‚
ç®€è€Œè¨€ä¹‹ï¼Œå‡è®¾æ˜¯æŸä¸ªç±»ä¸­æŸä¸ªè¦ç´ çš„å­˜åœ¨ç‹¬ç«‹äºåŒä¸€ç±»ä¸­å…¶ä»–ä»»ä½•è¦ç´ çš„å­˜åœ¨ã€‚
Pï¼ˆL | featuresï¼‰\:= \:\ frac {Pï¼ˆLï¼‰Pï¼ˆfeatures | Lï¼‰} {Pï¼ˆfeatures}}
åœ¨è¿™é‡Œï¼Œï¼ˆğ¿|ğ‘“ğ‘’ğ‘ğ‘¡ğ‘¢ğ‘Ÿğ‘’ğ‘ ï¼‰æ˜¯ç±»åˆ«çš„åéªŒæ¦‚ç‡ã€‚ç±»åˆ«çš„åéªŒæ¦‚ç‡æ˜¯æŒ‡ç»™å®šæŸä¸ªç‰¹å¾å‘é‡åï¼ŒæŸä¸ªç±»åˆ«å‡ºç°çš„æ¦‚ç‡:P(A|B) = P(B|A) * P(A) / P(B)
ğ‘ƒï¼ˆğ¿ï¼‰æ˜¯ç±»åˆ«çš„å…ˆéªŒæ¦‚ç‡ã€‚
ğ‘ƒï¼ˆğ‘“ğ‘’ğ‘ğ‘¡ğ‘¢ğ‘Ÿğ‘’ğ‘ |ğ¿ï¼‰æ˜¯ä¼¼ç„¶åº¦ï¼Œå®ƒæ˜¯ç»™å®šç±»åˆ«çš„é¢„æµ‹å˜é‡çš„æ¦‚ç‡ã€‚
ğ‘ƒï¼ˆğ‘“ğ‘’ğ‘ğ‘¡ğ‘¢ğ‘Ÿğ‘’ğ‘ ï¼‰æ˜¯é¢„æµ‹å˜é‡çš„å…ˆéªŒæ¦‚ç‡ã€‚æŒ‡åœ¨è§‚å¯Ÿåˆ°ä»»ä½•æ•°æ®ä¹‹å‰ï¼Œé¢„æµ‹å˜é‡æ¯ä¸ªå¯èƒ½å–å€¼çš„æ¦‚ç‡
"""

# åœ¨Pythonä¸­ä½¿ç”¨æœ´ç´ è´å¶æ–¯æ„å»ºæ¨¡å‹
"""
1.é«˜æ–¯æœ´ç´ è´å¶æ–¯ï¼šæœ€ç®€å•çš„æœ´ç´ è´å¶æ–¯åˆ†ç±»å™¨ï¼Œå…¶å‡è®¾æ˜¯æ¯ä¸ªæ ‡ç­¾çš„æ•°æ®å‡æ¥è‡ªç®€å•çš„é«˜æ–¯åˆ†å¸ƒ
2.å¤šé¡¹å¼æœ´ç´ è´å¶æ–¯ï¼šå…¶ä¸­çš„ç‰¹å¾è¢«è®¤ä¸ºæ˜¯ä»ç®€å•çš„å¤šé¡¹å¼åˆ†å¸ƒä¸­å¾—å‡ºçš„ã€‚è¿™ç§æœ´ç´ çš„è´å¶æ–¯æœ€é€‚åˆä»£è¡¨ç¦»æ•£è®¡æ•°çš„åŠŸèƒ½
3.ä¼¯åŠªåˆ©æœ´ç´ è´å¶æ–¯ï¼šå…¶ä¸­çš„ç‰¹å¾è¢«å‡å®šä¸ºäºŒè¿›åˆ¶ã€‚
"""


# é«˜æ–¯æœ´ç´ è´å¶æ–¯æ¨¡å‹
#å¯¼åº“
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns; sns.set()

# ç”Ÿæˆé«˜æ–¯åˆ†å¸ƒçš„æ•°æ®
from sklearn.datasets import make_blobs
# 300æ ·æœ¬ï¼Œæ¯ä¸ªæ ·æœ¬2ä¸ªç‰¹å¾ï¼Œ2ä¸ªç°‡ï¼Œéšæœºç§å­ï¼Œæ ‡å‡†å·®
X, y = make_blobs(300,2,centers=2,random_state=2,cluster_std=1.5)
plt.scatter(X[:,0],X[:,1],c=y,s=50,cmap='viridis')
# plt.show()

# GaussionNBæ¨¡å‹
from sklearn.naive_bayes import GaussianNB
model_GNB = GaussianNB()
model_GNB = model_GNB.fit(X,y)

# ç”Ÿæˆæ–°æ•°æ®ä¹‹åè¿›è¡Œé¢„æµ‹
rng = np.random.RandomState(0)      # åˆ›å»ºä¸€ä¸ªéšæœºæ•°ç”Ÿæˆå™¨ï¼Œéšæœºæ•°ç§å­è®¾å®šä¸º0
Xnew = [-6,-14] + [14,18]*rng.rand(2000,2)  # èµ·å§‹å€¼ä¸éšæœºæ•°ç›¸åŠ 
# print(Xnew[0])
ynew = model_GNB.predict(Xnew)

# ç»˜åˆ¶æ–°æ•°æ®ä»¥æŸ¥æ‰¾å…¶è¾¹ç•Œ
plt.scatter(X[:,0],X[:,1],c=y,s=50,cmap="summer")
lim = plt.axis()        # è·å–å½“å‰æœ€æ ‡è½´èŒƒå›´(-5.864572514057202, 5.478233350869923, -14.00968321776786, 4.460699874510104)
# print(lim)
plt.scatter(Xnew[:, 0], Xnew[:, 1], c = ynew, s = 20, cmap = 'summer', alpha = 0.1)     # alphaè®¾ç½®æ¯ä¸ªç‚¹çš„é€æ˜åº¦
plt.axis(lim)

# æ‰¾åˆ°ç¬¬ä¸€å’Œç¬¬äºŒä¸ªæ ‡ç­¾çš„åéªŒæ¦‚ç‡
yprob = model_GNB.predict_proba(Xnew)
yprob[-10:].round(3)
print(yprob)